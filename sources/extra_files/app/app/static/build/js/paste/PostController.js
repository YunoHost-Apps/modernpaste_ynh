var modernPaste={universal:{}};modernPaste.universal.AlertController=function(){modernPaste.universal.AlertController.ALERT_TYPE_SUCCESS="alert_type_success";modernPaste.universal.AlertController.ALERT_TYPE_FAILURE="alert_type_failure"};
modernPaste.universal.AlertController.displayAlert=function(a,b){this.alertContainer=$("#alert");this.alertMessage=this.alertContainer.find(".alert-message");this.alertTitle=this.alertContainer.find(".alert-title");this.alertContainer.removeClass();a===this.ALERT_TYPE_SUCCESS?(this.alertTitle.text(""),this.alertContainer.addClass("alert-success")):a===this.ALERT_TYPE_FAILURE&&(this.alertTitle.text("There was an error processing your request."),this.alertContainer.addClass("alert-error"));this.alertMessage.text(b);
this.alertContainer.css("visibility","visible");this.alertContainer.css("opacity",.8);setTimeout(function(){this.alertContainer.css("opacity",0);setTimeout(function(){this.alertContainer.css("visibility","hidden")}.bind(this),600)}.bind(this),4E3)};modernPaste.universal.AlertController.displaySuccessAlert=function(a){modernPaste.universal.AlertController.displayAlert(modernPaste.universal.AlertController.ALERT_TYPE_SUCCESS,a)};
modernPaste.universal.AlertController.displayErrorAlert=function(a){modernPaste.universal.AlertController.displayAlert(modernPaste.universal.AlertController.ALERT_TYPE_FAILURE,a)};modernPaste.universal.AlertController.selectErrorMessage=function(a,b){return void 0===a.responseJSON||void 0===a.responseJSON.failure?"There was an internal server-side error. Please try again later.":b.hasOwnProperty(a.responseJSON.failure)?b[a.responseJSON.failure]:"There was an internal server-side error. Please try again later."};
$(document).ready(function(){new modernPaste.universal.AlertController});modernPaste.universal.CommonController=function(){};
modernPaste.universal.CommonController.unixTimestampToRelativeTime=function(a){var b=function(a,b){return 1===b?a:a+"s"};a=new Date(1E3*parseInt(a,10));a=(new Date-a)/1E3;var c=a/60,d=c/60,e=d/24,f=e/30,g=f/12;return 1<=g?Math.round(g)+b(" year",Math.round(g))+" ago":1<=f?Math.round(f)+b(" month",Math.round(f))+" ago":1<=e?Math.round(e)+b(" day",Math.round(e))+" ago":1<=d?Math.round(d)+b(" hour",Math.round(d))+" ago":1<=c?Math.round(c)+b(" minute",Math.round(c))+" ago":Math.round(a)+b(" second",Math.round(a))+
" ago"};modernPaste.universal.CommonController.truncateText=function(a,b){return a.length>b?a.substring(0,b)+"...":a};modernPaste.universal.CommonController.getFileExtensionForType=function(a){var b={text:".txt",coffeescript:".coffee",css:".css",htmlmixed:".html",javascript:".js",jinja2:".html",markdown:".md",php:".php",python:".py",sass:".scss",sql:".sql",verilog:".v",yaml:".yml"},c="";b.hasOwnProperty(a.toLowerCase())&&(c=b[a.toLowerCase()]);return c};
modernPaste.universal.CommonController.formatFileSize=function(a,b){void 0===b&&(b=2);var c=a/1E3,d=c/1E3,e=d/1E3;return 1<=e?e.toFixed(b)+" GB":1<=d?d.toFixed(b)+" MB":1<=c?c.toFixed(b)+" KB":a.toFixed(b)+" B"};modernPaste.universal.CommonController.escapeSelector=function(a){return a.replace(/(:|\.|\[|\]|,)/g,"\\$1")};$(document).ready(function(){new modernPaste.universal.CommonController});modernPaste.universal.URIController=function(){var a=$("#uris");modernPaste.universal.URIController.uris={};for(var b=0;b<a.children().length;b++){var c=$(a.children()[b]);modernPaste.universal.URIController.uris[c.attr("id")]=c.text()}};modernPaste.universal.URIController.formatURI=function(a,b){var c=a,d=[],e;for(e in b)b.hasOwnProperty(e)&&(0<a.indexOf("<"+e+">")?c=c.split("<"+e+">").join(b[e]):d.push(e+"="+b[e]));return 0<d.length?c+"?"+d.join("&"):c};
modernPaste.universal.URIController.getURLParameters=function(){for(var a=document.location.search.split("+").join(" "),b={},c,d=/[?&]?([^=]+)=([^&]*)/g;c=d.exec(a);)b[decodeURIComponent(c[1])]=decodeURIComponent(c[2]);return b};$(document).ready(function(){new modernPaste.universal.URIController});modernPaste.paste={};
modernPaste.paste.PostController=function(){this.metadata={maxAttachmentSize:$("#metadata #max-attachment-size").data("max-attachment-size")};this.attachments=[];this.urlParams=modernPaste.universal.URIController.getURLParameters();this.alert=$("#alert");this.moreOptionsContainer=$(".more-options-container");this.moreOptionsArrow=$(".more-options-container .arrow");this.moreOptionsLink=$(".more-options-container .more-options-link");this.languageSelector=$(".language-selector");this.dateTimePicker=
$("#date-time-picker");this.pastePassword=$(".more-options-container .paste-password");this.codeMirrorContainer=$("#paste-post-contents");this.lineCounter=$("#footer").find(".statistics-section .line-count");this.characterCounter=$("#footer").find(".statistics-section .character-count");this.pasteDownloadLink=$("#footer").find(".submit-section .paste-download-link");this.pasteDownloadContent=$("#footer").find(".submit-section .paste-download-content");this.pasteTitle=$(".paste-title-container").find(".paste-title");
this.submitButton=$("#footer").find(".submit-section .submit-button");this.pasteSubmitSplash=$(".paste-submit-splash");this.attachmentsBrowseButton=$(".paste-attachments-container").find(".attachments-browse-button");this.attachmentsBrowseInput=$(".paste-attachments-container").find("#attachments-browse-input");this.attachmentsList=$(".paste-attachments-container").find(".attachments-list");this.attachmentItemTemplate=$("#attachment-item-template");this.attachmentUploadingStatus=$(".paste-submit-splash .uploading-status");
this.submitButton.prop("disabled",!1);this.dateTimePicker.datetimepicker({});this.pasteContents=CodeMirror(this.codeMirrorContainer[0],{autofocus:!0,lineNumbers:!0,viewportMargin:Infinity,lineWrapping:!0,mode:""});this.urlParams.hasOwnProperty("fork")&&modernPaste.paste.PostController.loadForkedPasteContents.bind(this)();this.moreOptionsLink.on("click",modernPaste.paste.PostController.handleMoreOptionLinkClick.bind(this));this.languageSelector.on("change",modernPaste.paste.PostController.handleLanguageSelectorChange.bind(this));
this.pasteContents.on("change",modernPaste.paste.PostController.handlePasteContentsChange.bind(this));this.pasteDownloadLink.on("click",modernPaste.paste.PostController.handlePasteDownloadLinkClick.bind(this));this.submitButton.on("click",modernPaste.paste.PostController.handleSubmitButtonClick.bind(this));this.attachmentsBrowseButton.on("click",modernPaste.paste.PostController.handleAttachmentsBrowseButtonClick.bind(this));this.attachmentsBrowseInput.on("change",modernPaste.paste.PostController.handleAttachmentsFileInput.bind(this))};
modernPaste.paste.PostController.handleMoreOptionLinkClick=function(a){a.preventDefault();"25px"===this.moreOptionsContainer.css("height")?(this.moreOptionsArrow.css("transform","rotate(-90deg)"),this.moreOptionsContainer.css("height","170px")):(this.moreOptionsArrow.css("transform","rotate(90deg)"),this.moreOptionsContainer.css("height","25px"))};modernPaste.paste.PostController.handleLanguageSelectorChange=function(a){a.preventDefault();this.pasteContents.setOption("mode",this.languageSelector.val().toLowerCase())};
modernPaste.paste.PostController.handlePasteContentsChange=function(a){this.lineCounter.text(this.pasteContents.lineCount());this.characterCounter.text(this.pasteContents.getValue().length)};modernPaste.paste.PostController.handlePasteDownloadLinkClick=function(a){a.preventDefault();this.pasteDownloadContent.attr("download",this.pasteTitle.val()+".txt");this.pasteDownloadContent.attr("href","data:text/plain;base64,"+window.btoa(this.pasteContents.getValue()));this.pasteDownloadContent[0].click()};
modernPaste.paste.PostController.handleSubmitButtonClick=function(a){a.preventDefault();this.submitButton.prop("disabled",!0);modernPaste.universal.SplashController.showSplash(this.pasteSubmitSplash);$.ajax({xhr:function(){var a=new window.XMLHttpRequest;a.upload.addEventListener("progress",function(a){a.lengthComputable&&(a=100*a.loaded/a.total,0<this.attachments.length&&this.attachmentUploadingStatus.text("UPLOADING ATTACHMENTS - "+Math.round(a)+"%"))}.bind(this),!1);return a}.bind(this),method:"POST",
url:modernPaste.universal.URIController.uris.PasteSubmitURI,contentType:"application/json",data:JSON.stringify({contents:this.pasteContents.getValue(),expiry_time:Math.round(Date.parse(this.dateTimePicker.val())/1E3),title:this.pasteTitle.val(),language:this.languageSelector.val().toLowerCase(),password:""!==this.pastePassword.val()?this.pastePassword.val():null,attachments:this.attachments})}).done(modernPaste.paste.PostController.handleSubmitSuccess.bind(this)).fail(modernPaste.paste.PostController.handleSubmitFail.bind(this))};
modernPaste.paste.PostController.handleSubmitSuccess=function(a){window.location.href=modernPaste.universal.URIController.formatURI(modernPaste.universal.URIController.uris.PasteViewInterfaceURI,{paste_id:a.paste_id_repr})};
modernPaste.paste.PostController.handleSubmitFail=function(a){modernPaste.universal.SplashController.hideSplash(this.pasteSubmitSplash);this.submitButton.prop("disabled",!1);modernPaste.universal.AlertController.displayErrorAlert(modernPaste.universal.AlertController.selectErrorMessage(a,{incomplete_params_failure:"You can't submit an empty paste.",auth_failure:"You need to be logged in to post a non-anonymous paste.",unauthenticated_pastes_disabled_failure:"The server administrator has required that users be signed in to post a paste.",
paste_attachments_disabled_failure:"The server administrator has disabled paste attachments.",paste_attachment_too_large_failure:"The size of one or more attachments is larger than the maximum allowable file size."}))};modernPaste.paste.PostController.handleAttachmentsBrowseButtonClick=function(a){a.preventDefault();this.attachmentsBrowseInput.click()};
modernPaste.paste.PostController.handleAttachmentsFileInput=function(a){a.target.files&&$.each(a.target.files,function(a,c){var d=new FileReader;d.onload=function(a){this.attachments.push({name:c.name,mime_type:c.type,size:c.size,data:btoa(a.target.result)});a=this.attachmentsList.find("#"+modernPaste.universal.CommonController.escapeSelector(c.name));a.removeClass("faded");a.find(".delete-attachment-icon").removeClass("hidden");a.find(".attachment-loading-icon").addClass("hidden")}.bind(this);var e=
this.attachments.filter(function(a){return a.name===c.name});c.size>1E6*this.metadata.maxAttachmentSize&&0<this.metadata.maxAttachmentSize?modernPaste.universal.AlertController.displayErrorAlert("This file's size exceeds the limit of "+this.metadata.maxAttachmentSize+" MB imposed by the server administrator."):0<e.length?modernPaste.universal.AlertController.displayErrorAlert("This file name already exists as an attachment for this paste."):(d.readAsBinaryString(c),this.attachmentsList.removeClass("hidden"),
d=$(this.attachmentItemTemplate.html()),d.prop("id",c.name),d.find(".attachment-name").text(c.name+" ("+modernPaste.universal.CommonController.formatFileSize(c.size)+")"),d.find(".delete-attachment-icon").on("click",modernPaste.paste.PostController.handleAttachmentDeletion.bind(this,c)),this.attachmentsList.append(d))}.bind(this))};
modernPaste.paste.PostController.handleAttachmentDeletion=function(a){this.attachments=this.attachments.filter(function(b){return b.name!==a.name});this.attachmentsList.find("#"+modernPaste.universal.CommonController.escapeSelector(a.name)).remove();0===this.attachments.length&&this.attachmentsList.addClass("hidden")};
modernPaste.paste.PostController.loadForkedPasteContents=function(){$.ajax({method:"POST",url:modernPaste.universal.URIController.uris.PasteDetailsURI,contentType:"application/json",data:JSON.stringify({paste_id:this.urlParams.fork})}).done(modernPaste.paste.PostController.insertForkedPaste.bind(this)).fail(modernPaste.paste.PostController.showPasteForkFail.bind(this))};
modernPaste.paste.PostController.insertForkedPaste=function(a){this.pasteContents.setValue(a.details.contents);this.languageSelector.val(a.details.language.toLowerCase());this.pasteContents.setOption("mode",a.details.language.toLowerCase());this.pasteTitle.val("Fork of "+a.details.title)};
modernPaste.paste.PostController.showPasteForkFail=function(a){modernPaste.universal.AlertController.displayErrorAlert(modernPaste.universal.AlertController.selectErrorMessage(a,{password_mismatch_failure:"You cannot fork a password-protected paste.",nonexistent_paste_failure:"The paste you are trying to fork does not exist."}))};$(document).ready(function(){new modernPaste.paste.PostController});modernPaste.universal.MenuController=function(){this.menuToggleButton=$("#header").find(".container .menu-button");this.menuPanel=$("#menu-panel");this.pageHeader=$("#header");this.pageFooter=$("#footer");this.mainPage=$("#main-page");this.userHeader=$("#header").find(".user-section .user-header");this.userHeaderDropdown=$("#user-header-dropdown");this.openSourceNote=this.menuPanel.find(".open-source-note");this.menuToggleButton.on("click",modernPaste.universal.MenuController.handleMenuToggleButtonClick.bind(this));
$("html").on("click",modernPaste.universal.MenuController.handleWindowClick.bind(this));$(window).on("resize",modernPaste.universal.MenuController.toggleOpenSourceNoteVisibility.bind(this))};modernPaste.universal.MenuController.toggleOpenSourceNoteVisibility=function(){500<(window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight)?this.openSourceNote.show():this.openSourceNote.hide()};
modernPaste.universal.MenuController.handleWindowClick=function(a){modernPaste.universal.MenuController.isMenuPanelVisible.bind(this)()&&this.menuPanel[0]!==$(a.target)[0]&&0===this.menuPanel.has($(a.target)).length&&modernPaste.universal.MenuController.hideMenuPanel.bind(this)()};
modernPaste.universal.MenuController.handleMenuToggleButtonClick=function(a){a.preventDefault();modernPaste.universal.MenuController.isMenuPanelVisible.bind(this)()?modernPaste.universal.MenuController.hideMenuPanel.bind(this)():modernPaste.universal.MenuController.showMenuPanel.bind(this)()};
modernPaste.universal.MenuController.hideMenuPanel=function(){this.menuToggleButton.fadeOut(function(){$(this).attr("class","fa fa-bars fa-large menu-button");$(this).fadeIn()});this.menuPanel.css("margin-left","-310px");this.pageHeader.css("margin-left","0");this.mainPage.css("margin-left","0");0<this.pageFooter.length&&this.pageFooter.css("margin-left","0")};
modernPaste.universal.MenuController.showMenuPanel=function(){this.userHeaderDropdown.is(":visible")&&this.userHeader.click();this.menuToggleButton.fadeOut(function(){$(this).attr("class","fa fa-times menu-button");$(this).fadeIn()});this.menuPanel.css("margin-left","0");this.pageHeader.css("margin-left","310px");this.mainPage.css("margin-left","310px");0<this.pageFooter.length&&this.pageFooter.css("margin-left","310px")};
modernPaste.universal.MenuController.isMenuPanelVisible=function(){return"0"===this.menuPanel.css("margin-left")||"0px"===this.menuPanel.css("margin-left")};$(document).ready(function(){new modernPaste.universal.MenuController});modernPaste.universal.SplashController=function(){Pace.options={ajax:!1};this.loadingSplash=$("#loading-splash");Pace.on("done",modernPaste.universal.SplashController.hideLoadingSplash.bind(this))};modernPaste.universal.SplashController.showSplash=function(a){a.css("visibility","visible");a.css("opacity",.6)};modernPaste.universal.SplashController.hideSplash=function(a){a.css("opacity",0);setTimeout(function(){a.css("visibility","hidden")}.bind(this),600)};
modernPaste.universal.SplashController.hideLoadingSplash=function(){modernPaste.universal.SplashController.hideSplash(this.loadingSplash)};$(document).ready(function(){new modernPaste.universal.SplashController});modernPaste.universal.UserHeaderController=function(){this.userHeader=$("#header").find(".user-section .user-header");this.userMenuArrow=this.userHeader.find(".user-menu-arrow");this.userHeaderDropdown=$("#user-header-dropdown");this.userHeader.on("click",modernPaste.universal.UserHeaderController.toggleDropdownVisibility.bind(this))};
modernPaste.universal.UserHeaderController.toggleDropdownVisibility=function(a){a.preventDefault();this.userHeaderDropdown.is(":visible")?(this.userMenuArrow.css("transform","rotate(90deg)"),this.userHeaderDropdown.slideUp({duration:600,easing:"easeOutQuint"})):(this.userMenuArrow.css("transform","rotate(-90deg)"),this.userHeaderDropdown.slideDown({duration:600,easing:"easeOutQuint"}))};$(document).ready(function(){new modernPaste.universal.UserHeaderController});
